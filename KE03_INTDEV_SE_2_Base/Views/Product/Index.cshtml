@model IEnumerable<DataAccessLayer.Models.Product>


@section Styles {
    <link rel="stylesheet" href="~/css/site.css" />
}

<h2>Producten</h2>

<a asp-action="Create" class="btn btn-success mb-3" title="Nieuw product">
    <i class="bi bi-plus-lg"></i> Nieuw product
</a>

@{
    string currentSort = ViewBag.CurrentSort as string ?? "Name";
    string currentDir = ViewBag.CurrentDir as string ?? "asc";

    Func<string, string> sortIcon = sort =>
    {
        if (sort != currentSort) return "";
        return currentDir == "asc" ? "▲" : "▼";
    };

    Func<string, string> nextDir = sort =>
    {
        return sort == currentSort && currentDir == "asc" ? "desc" : "asc";
    };
}

<table class="table">
    <thead>
        <tr>
            <th>
                <a asp-action="Index" asp-route-sort="Name" asp-route-dir="@nextDir("Name")">
                    Naam @sortIcon("Name")
                </a>
            </th>
            <th>
                <a asp-action="Index" asp-route-sort="Category" asp-route-dir="@nextDir("Category")">
                    Categorie @sortIcon("Category")
                </a>
            </th>
            <th>
                <a asp-action="Index" asp-route-sort="Brand" asp-route-dir="@nextDir("Brand")">
                    Merk @sortIcon("Brand")
                </a>
            </th>
            <th>
                <a asp-action="Index" asp-route-sort="Price" asp-route-dir="@nextDir("Price")">
                    Prijs @sortIcon("Price")
                </a>
            </th>
            <th>
                <a asp-action="Index" asp-route-sort="Stock" asp-route-dir="@nextDir("Stock")">
                    Voorraad @sortIcon("Stock")
                </a>
            </th>
            <th class="text-end">Beheren</th> 
        </tr>
    </thead>
    <tbody>
        @foreach (var p in Model)
        {
                <tr class="@(p.Stock <= 5 ? "table-danger" : "")">
                <td>@p.Name</td>
                <td>@p.Category</td>
                <td>@p.Brand</td>
                <td>@(p.Price.ToString("0.00"))</td>
                
                <td class="@(p.Stock <= 5 ? "text-danger fw-bold" : "")">
                    @Html.Raw(p.Stock + (p.Stock <= 5 ? "<span class='ms-1 text-danger fw-bold'>(Laag voorraad)</span>" : ""))
                </td>
                <td class="text-end">
                    <a asp-action="Details" asp-route-id="@p.Id" class="btn btn-outline-secondary btn-sm me-1" title="Details">
                        <i class="bi bi-info-circle"></i>
                    </a>
                    <a asp-action="Edit" asp-route-id="@p.Id" class="btn btn-outline-secondary btn-sm me-1" title="Bewerken">
                        <i class="bi bi-pencil"></i>
                    </a>
                    <a asp-action="Delete" asp-route-id="@p.Id" class="btn btn-outline-secondary btn-sm" title="Verwijderen">
                        <i class="bi bi-trash"></i>
                    </a>
                </td>
            </tr>
        }
    </tbody>
</table>